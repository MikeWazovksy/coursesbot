# ü§ñ Telegram-–±–æ—Ç –¥–ª—è –ø—Ä–æ–¥–∞–∂–∏ –æ–Ω–ª–∞–π–Ω-–∫—É—Ä—Å–æ–≤

–ú–Ω–æ–≥–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π Telegram-–±–æ—Ç –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –ø—Ä–æ–¥–∞–∂–∏ –æ–Ω–ª–∞–π–Ω-–∫—É—Ä—Å–æ–≤ —Å –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å—é, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π –∏ –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–µ–π —Å –ø–ª–∞—Ç–µ–∂–Ω–æ–π —Å–∏—Å—Ç–µ–º–æ–π –ÆKassa —á–µ—Ä–µ–∑ Telegram Payments.

---

## üöÄ –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### –î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

- üéì **–ö–∞—Ç–∞–ª–æ–≥ –∫—É—Ä—Å–æ–≤** ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä —Å–ø–∏—Å–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫—É—Ä—Å–æ–≤ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –∏ —Ü–µ–Ω–∞–º–∏.
- üí≥ **–ü–æ–∫—É–ø–∫–∞** ‚Äî –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ÆKassa —á–µ—Ä–µ–∑ Telegram Payment API.
- ‚è± **–ê–≤—Ç–æ–æ—Ç–º–µ–Ω–∞ –Ω–µ–æ–ø–ª–∞—á–µ–Ω–Ω—ã—Ö –∑–∞–∫–∞–∑–æ–≤** ‚Äî –µ—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ –∑–∞–≤–µ—Ä—à–∏–ª –æ–ø–ª–∞—Ç—É –∑–∞ 10 –º–∏–Ω—É—Ç, –∑–∞–∫–∞–∑ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–º–µ–Ω—è–µ—Ç—Å—è.
- ü§ñ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤—ã–¥–∞—á–∞ –¥–æ—Å—Ç—É–ø–∞** ‚Äî –ø–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã –±–æ—Ç –º–≥–Ω–æ–≤–µ–Ω–Ω–æ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º –∫—É—Ä—Å–∞.
- üìö **–õ–∏—á–Ω—ã–π –∫–∞–±–∏–Ω–µ—Ç** ‚Äî —Ä–∞–∑–¥–µ–ª—ã "–ú–æ–∏ –∫—É—Ä—Å—ã" –∏ "–ò—Å—Ç–æ—Ä–∏—è –ø–æ–∫—É–ø–æ–∫" –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞ –∫ –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º –∏ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø–ª–∞—Ç–µ–∂–µ–π.

### –î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤

- üîê **–ó–∞—â–∏—â—ë–Ω–Ω–∞—è –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å** ‚Äî –¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –¥–ª—è ID –∏–∑ —Å–ø–∏—Å–∫–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤.
- ‚ûï **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—É—Ä—Å–∞–º–∏ (CRUD)**
  - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –∫—É—Ä—Å–æ–≤ —á–µ—Ä–µ–∑ –ø–æ—à–∞–≥–æ–≤—ã–π –¥–∏–∞–ª–æ–≥
  - –ü—Ä–æ—Å–º–æ—Ç—Ä, —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∫—É—Ä—Å–æ–≤
- üë• **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏** ‚Äî –ø—Ä–æ—Å–º–æ—Ç—Ä –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø–∞–≥–∏–Ω–∞—Ü–∏–µ–π.
- üìä **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞** ‚Äî –∫–ª—é—á–µ–≤—ã–µ –º–µ—Ç—Ä–∏–∫–∏: –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –ø–æ–∫—É–ø–æ–∫, –æ–±—â–∞—è —Å—É–º–º–∞ –¥–æ—Ö–æ–¥–∞.
- üõ°Ô∏è **–ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å** ‚Äî –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –º–µ—Ö–∞–Ω–∏–∑–º –∑–∞—â–∏—Ç—ã –æ—Ç —Ñ–ª—É–¥–∞ (—Ç—Ä–æ—Ç—Ç–ª–∏–Ω–≥).

---

## üõ†Ô∏è –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

- **Python 3.10+**
- **Aiogram 3** ‚Äî –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π —Ñ—Ä–µ–π–º–≤–æ—Ä–∫ –¥–ª—è Telegram Bot API
- **AIOHTTP** ‚Äî –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å –≤–µ–±—Ö—É–∫–∞–º–∏
- **asyncpg** ‚Äî –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –¥—Ä–∞–π–≤–µ—Ä –¥–ª—è PostgreSQL
- **–ÆKassa —á–µ—Ä–µ–∑ Telegram Payment API** ‚Äî –ø—Ä–∏—ë–º –ø–ª–∞—Ç–µ–∂–µ–π
- **Nginx, Gunicorn, systemd** ‚Äî –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –Ω–∞ VPS

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
coursesbot/
‚îÇ‚îÄ‚îÄ bot.py
‚îÇ‚îÄ‚îÄ config.py
‚îÇ‚îÄ‚îÄ database.py
‚îÇ‚îÄ‚îÄ requirements.txt
‚îÇ‚îÄ‚îÄ .env
‚îÇ‚îÄ‚îÄ .gitignore
‚îÇ‚îÄ‚îÄ README.md
‚îÇ
‚îú‚îÄ‚îÄ handlers/
‚îÇ   ‚îú‚îÄ‚îÄ user.py
‚îÇ   ‚îú‚îÄ‚îÄ admin.py
‚îÇ   ‚îî‚îÄ‚îÄ payments.py
‚îÇ
‚îú‚îÄ‚îÄ keyboards/
‚îÇ   ‚îú‚îÄ‚îÄ user_kb.py
‚îÇ   ‚îî‚îÄ‚îÄ admin_kb.py
‚îÇ
‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îú‚îÄ‚îÄ users.py
‚îÇ   ‚îú‚îÄ‚îÄ courses.py
‚îÇ   ‚îú‚îÄ‚îÄ payments.py
‚îÇ   ‚îú‚îÄ‚îÄ user_courses.py
‚îÇ   ‚îî‚îÄ‚îÄ stats.py
‚îÇ
‚îú‚îÄ‚îÄ migrations/
‚îÇ   ‚îú‚îÄ‚îÄ 001_init.sql
‚îÇ   ‚îî‚îÄ‚îÄ 002_add_indexes.sql
‚îÇ
‚îú‚îÄ‚îÄ states/
‚îÇ   ‚îî‚îÄ‚îÄ admin_states.py
‚îÇ
‚îú‚îÄ‚îÄ middlewares/
‚îÇ   ‚îî‚îÄ‚îÄ throttling.py
‚îÇ
‚îî‚îÄ‚îÄ filters/
    ‚îî‚îÄ‚îÄ admin.py
```

---

## ‚öôÔ∏è –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

### 1Ô∏è‚É£ –ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π

```bash
git clone <URL-–≤–∞—à–µ–≥–æ-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è>
cd <–Ω–∞–∑–≤–∞–Ω–∏–µ-–ø–∞–ø–∫–∏-–ø—Ä–æ–µ–∫—Ç–∞>
```

### 2Ô∏è‚É£ –°–æ–∑–¥–∞–π—Ç–µ –∏ –∞–∫—Ç–∏–≤–∏—Ä—É–π—Ç–µ –≤–∏—Ä—Ç—É–∞–ª—å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ

**Windows**:

```bash
python -m venv venv
venv\Scripts\activate
```

**macOS / Linux**:

```bash
python3 -m venv venv
source venv/bin/activate
```

### 3Ô∏è‚É£ –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
pip install -r requirements.txt
```

### 4Ô∏è‚É£ –ù–∞—Å—Ç—Ä–æ–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–æ–∑–¥–∞–π—Ç–µ —Ñ–∞–π–ª `.env` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –µ–≥–æ:

```ini
BOT_TOKEN="..."
ADMIN_IDS="..."
PAYMENT_PROVIDER_TOKEN="..."
WEBHOOK_HOST="https://your-domain.com"
DATABASE_URL=postgresql://coursesbot_user:your_password@localhost:5432/coursesbot_db
```

---

## üñ•Ô∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ PostgreSQL –Ω–∞ VPS

```bash
sudo apt update
sudo apt install postgresql postgresql-contrib -y
sudo -i -u postgres
psql
```

–í–Ω—É—Ç—Ä–∏ `psql` —Å–æ–∑–¥–∞–µ–º –±–∞–∑—É –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:

```sql
CREATE DATABASE coursesbot_db;
CREATE USER coursesbot_user WITH ENCRYPTED PASSWORD 'your_password';
GRANT ALL PRIVILEGES ON DATABASE coursesbot_db TO coursesbot_user;
\q
exit
```

–ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ PostgreSQL:

```bash
sudo systemctl restart postgresql
```

---

## 5Ô∏è‚É£ Production –Ω–∞ Render.com

1. –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∫–æ–¥ –Ω–∞ GitHub.
2. –°–æ–∑–¥–∞–π—Ç–µ Web Service, –ø–æ–¥–∫–ª—é—á–∏–≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π.
3. –î–æ–±–∞–≤—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è.

---

## 6Ô∏è‚É£ Production –Ω–∞ VPS (Ubuntu 22.04)

### 6.1 –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞

```bash
ssh root@–í–ê–®_IP_–ê–î–†–ï–°
adduser your_user
usermod -aG sudo your_user
ufw allow OpenSSH
ufw allow 'Nginx Full'
ufw enable
ssh your_user@–í–ê–®_IP_–ê–î–†–ï–°
```

### 6.2 –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏ –ø—Ä–æ–µ–∫—Ç–∞

```bash
sudo apt update && sudo apt upgrade -y
sudo apt install python3-pip python3-venv nginx git -y

git clone https://github.com/–≤–∞—à_–ª–æ–≥–∏–Ω/–≤–∞—à_—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π.git
cd –≤–∞—à_—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
nano .env
```

### 6.3 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Nginx

```bash
sudo nano /etc/nginx/sites-available/your_bot
sudo ln -s /etc/nginx/sites-available/your_bot /etc/nginx/sites-enabled/
sudo nginx -t
sudo systemctl restart nginx
```

–ü—Ä–∏–º–µ—Ä –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ `your_bot`:

```
server {
    listen 80;
    server_name your-domain.com www.your-domain.com;

    location / {
        proxy_pass http://127.0.0.1:8080;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
    }
}
```

### 6.4 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ systemd

```bash
sudo nano /etc/systemd/system/your_bot.service
sudo systemctl daemon-reload
sudo systemctl enable your_bot.service
sudo systemctl start your_bot.service
sudo systemctl status your_bot.service
sudo journalctl -u your_bot.service -f
```

–ü—Ä–∏–º–µ—Ä —Å–µ—Ä–≤–∏—Å–∞:

```
[Unit]
Description=Telegram Course Bot
After=network.target

[Service]
User=your_user
Group=www-data
WorkingDirectory=/home/your_user/–≤–∞—à_—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
ExecStart=/home/your_user/–≤–∞—à_—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π/venv/bin/python bot.py
Restart=always

[Install]
WantedBy=multi-user.target
```

### 6.5 –ù–∞—Å—Ç—Ä–æ–π–∫–∞ HTTPS (Certbot)

```bash
sudo apt install certbot python3-certbot-nginx -y
sudo certbot --nginx
sudo systemctl restart nginx
sudo systemctl restart your_bot.service
```

---

## üïπÔ∏è –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

- `/start` ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –Ω–∞—á–∞–ª–æ —Ä–∞–±–æ—Ç—ã
- –ú–µ–Ω—é –∫–Ω–æ–ø–æ–∫ ‚Äî –Ω–∞–≤–∏–≥–∞—Ü–∏—è –ø–æ –∫—É—Ä—Å–∞–º, –ø—Ä–æ—Å–º–æ—Ç—Ä –ø–æ–∫—É–ø–æ–∫ –∏ –∏—Å—Ç–æ—Ä–∏–∏

### –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

- `/admin` ‚Äî –¥–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ –¥–ª—è ADMIN_IDS
- –ö–Ω–æ–ø–∫–∏ ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫—É—Ä—Å–∞–º–∏, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π

---

## üíñ –î–æ–Ω–∞—Ç—ã

–ï—Å–ª–∏ –≤–∞–º –ø–æ–Ω—Ä–∞–≤–∏–ª—Å—è –±–æ—Ç, –≤—ã –º–æ–∂–µ—Ç–µ –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –¥–æ–Ω–∞—Ç –Ω–∞ :

#### BTC: bc1qa3c5xdc6a3n2l3w0sq3vysustczpmlvhdwr8vc

–°–ø–∞—Å–∏–±–æ –∑–∞ –≤–∞—à—É –ø–æ–¥–¥–µ—Ä–∂–∫—É! üôè
